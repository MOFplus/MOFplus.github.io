

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1.1.1.1.1. molsys.addon package &mdash; molsys 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.1.1.1.2. molsys.fileIO package" href="molsys.fileIO.html" />
    <link rel="prev" title="1.1.1. molsys package" href="molsys.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> molsys
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_quickstart.html">1. Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_addon.html">2. Addons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_util.html">3. Utility Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Stuff</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tech_api.html">1. API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="modules.html">1.1. molsys</a></li>
<li class="toctree-l2"><a class="reference internal" href="molsys.html">1.1.1. molsys package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.1.1.1.1. molsys.addon package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">1.1.1.1.1.1. Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.base">1.1.1.1.1.2. molsys.addon.base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.bb">1.1.1.1.1.3. molsys.addon.bb module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.ff">1.1.1.1.1.4. molsys.addon.ff module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.fragments">1.1.1.1.1.5. molsys.addon.fragments module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.graph">1.1.1.1.1.6. molsys.addon.graph module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.molecules">1.1.1.1.1.7. molsys.addon.molecules module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon.ric">1.1.1.1.1.8. molsys.addon.ric module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molsys-addon-spg-module">1.1.1.1.1.9. molsys.addon.spg module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molsys-addon-zmat-module">1.1.1.1.1.10. molsys.addon.zmat module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-molsys.addon">1.1.1.1.1.11. Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="molsys.fileIO.html">1.1.1.1.2. molsys.fileIO package</a></li>
<li class="toctree-l2"><a class="reference internal" href="molsys.util.html">1.1.1.1.3. molsys.util package</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">File Formats</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../file_io.html">1. File Formats</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">molsys</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tech_api.html"><span class="section-number">1. </span>API Documentation</a> &raquo;</li>
        
          <li><a href="modules.html"><span class="section-number">1.1. </span>molsys</a> &raquo;</li>
        
          <li><a href="molsys.html"><span class="section-number">1.1.1. </span>molsys package</a> &raquo;</li>
        
      <li><span class="section-number">1.1.1.1.1. </span>molsys.addon package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/_api/molsys.addon.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="molsys-addon-package">
<h1><span class="section-number">1.1.1.1.1. </span>molsys.addon package<a class="headerlink" href="#molsys-addon-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2><span class="section-number">1.1.1.1.1.1. </span>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-molsys.addon.base">
<span id="molsys-addon-base-module"></span><h2><span class="section-number">1.1.1.1.1.2. </span>molsys.addon.base module<a class="headerlink" href="#module-molsys.addon.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="molsys.addon.base.base">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.base.</span></code><code class="sig-name descname"><span class="pre">base</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/base.html#base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.base.base" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.base.base.pprint">
<code class="sig-name descname"><span class="pre">pprint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/base.html#base.pprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.base.base.pprint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molsys.addon.bb">
<span id="molsys-addon-bb-module"></span><h2><span class="section-number">1.1.1.1.1.3. </span>molsys.addon.bb module<a class="headerlink" href="#module-molsys.addon.bb" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="molsys.addon.bb.bb">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.bb.</span></code><code class="sig-name descname"><span class="pre">bb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.bb.bb.align_pax_to_xyz">
<code class="sig-name descname"><span class="pre">align_pax_to_xyz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_connxyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.align_pax_to_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.align_pax_to_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Aligns the coordinates to match the three principal axes of the intertial tensor to the cartesian coordinate system.
Does not yet use weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>use_connxyz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, use only the coordinates of the connectors. Defaults to False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.connector_dist">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">connector_dist</span></code><a class="headerlink" href="#molsys.addon.bb.bb.connector_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>get the distance from the center (origin 0,0,0) to the connector positions</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.connector_xyz">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">connector_xyz</span></code><a class="headerlink" href="#molsys.addon.bb.bb.connector_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>get the xyz coords of the connector atoms
TBI: if a connector is two atoms compute the center of mass</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.contains_disorder">
<code class="sig-name descname"><span class="pre">contains_disorder</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reject_covrad_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.contains_disorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.contains_disorder" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>try to detect disordered parts of the structure based on heuristics:</dt><dd><ul class="simple">
<li><p>unusual bond lengths</p></li>
<li><p>unusual coordination numbers</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><p><strong>{float} -- consider bonds smaller than sum of vdw * fact as disordered</strong><strong> (</strong><strong>default</strong> (<em>reject_covrad_fact</em>) – {0.5})</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool – the answer to the question of the bb contains disorder</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.is_organic">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">is_organic</span></code><a class="headerlink" href="#molsys.addon.bb.bb.is_organic" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the bb contains only organic elements</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.remove_carboxylates">
<code class="sig-name descname"><span class="pre">remove_carboxylates</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co2mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_carboxy_H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.remove_carboxylates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.remove_carboxylates" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>this function is meant to be used to convert a molecule</dt><dd><p>which is not yet a bb type to a bb type by removing
carboxylates and carboxylic acid groups and adding
connectors where the carboxylates were</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>{molsys.mol} -- co2 mol object</strong><strong> (</strong><strong>default</strong> (<em>co2mol</em>) – {None})</p></li>
<li><p><strong>{bool} -- if true</strong><strong>, </strong><strong>carboxylic hydrogen atoms are removed</strong><strong> (</strong><strong>default</strong> (<em>remove_carboxy_H</em>) – {True})</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>molsys.mol – the mol object with removed carboxylates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.rotate_on_z">
<code class="sig-name descname"><span class="pre">rotate_on_z</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.rotate_on_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.rotate_on_z" title="Permalink to this definition">¶</a></dt>
<dd><p>especially if this is a linker (2 connectors) we want it to lie on the z-axis
we always use the first connector (could also be a regular SBU!) to be on the z-axis</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.setup">
<code class="sig-name descname"><span class="pre">setup</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_atypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate_on_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_to_pax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pax_use_connonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>setup the BB data (only use this method to setup BBs!)</p>
<p>TBI: possibility to have a sequence of indices for a connector -&gt; set a flag</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connector</strong> (<em>list of ints</em>) – list of connector atoms</p></li>
<li><p><strong>connector_atoms</strong> (<em>list of lists of ints</em><em>, </em><em>optional</em>) – actual atoms bonding. Defaults to None.</p></li>
<li><p><strong>connector_types</strong> (<em>list of ints</em><em>, </em><em>optional</em>) – if present then special connectors exist. Defaults to None.</p></li>
<li><p><strong>connector_atypes</strong> (<em>list of lists of strings</em><em>, </em><em>optional</em>) – atomtype of the atom to which the connector is bonded to
same layout as connector_atoms, if present then _types are generted. Defaults to None.</p></li>
<li><p><strong>center_type</strong> (<em>string</em><em>, </em><em>optional</em>) – either “com” or “coc” or “special”. if “special” center_xyz must be given. Defaults to “coc”.</p></li>
<li><p><strong>center_xyz</strong> (<em>numpy array</em><em>, </em><em>optional</em>) – coordinates of the center. Defaults to None.</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – The name of the BB</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.setup_with_bb_info">
<code class="sig-name descname"><span class="pre">setup_with_bb_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn_identifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'He'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.setup_with_bb_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.setup_with_bb_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a mol object with a given atom as conn_identifier label to a BB.
It can currently only work with a single conn_identifier, which means, that no special_connectors can be defined in this way.
:param conn_identifier: Atom type of the Atom used as connector label The connected atoms of the conn_identified atom will become the new connectors. Defaults to ‘He’.
:type conn_identifier: str, optional
:param center_point: Definition of which center to use in the BB. Defaults to ‘coc’.
:type center_point: str, optional</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.bb.bb.sort_connector_type">
<code class="sig-name descname"><span class="pre">sort_connector_type</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/bb.html#bb.sort_connector_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.bb.bb.sort_connector_type" title="Permalink to this definition">¶</a></dt>
<dd><p>This internal method sorts the connectors according to a rsing type</p>
<p>this is necessary for writing mfpx files, where the different types are seperated by a slash</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molsys.addon.ff">
<span id="molsys-addon-ff-module"></span><h2><span class="section-number">1.1.1.1.1.4. </span>molsys.addon.ff module<a class="headerlink" href="#module-molsys.addon.ff" title="Permalink to this headline">¶</a></h2>
<p>Class to administrate the FF parameters and to assign them.</p>
<p>The ff class is used to administrate the assignment of FF parameters
following our specific assignment approach and to vary the parameters
for FFgen runs.</p>
<dl class="field-list simple">
<dt class="field-odd">param molsys</dt>
<dd class="field-odd"><p>mol object for which parameters should be
assigned.</p>
</dd>
<dt class="field-even">type molsys</dt>
<dd class="field-even"><p>molsys.mol</p>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>par(potentials): Defaults to None. External potentials object</dt><dd><p>which should be used in this ff class. Only needed for multistructure
fits with FFgen.</p>
</dd>
</dl>
</dd>
<dt>Attr:</dt><dd><p>ric_type()
par()
par_ind()</p>
</dd>
</dl>
</div>
<div class="section" id="module-molsys.addon.fragments">
<span id="molsys-addon-fragments-module"></span><h2><span class="section-number">1.1.1.1.1.5. </span>molsys.addon.fragments module<a class="headerlink" href="#module-molsys.addon.fragments" title="Permalink to this headline">¶</a></h2>
<p>Created on Tue Nov 29 21:30:26 2016</p>
<p>&#64;author: rochus</p>
<dl class="py class">
<dt id="molsys.addon.fragments.fragments">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.fragments.</span></code><code class="sig-name descname"><span class="pre">fragments</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>fragments is an addon class to support advanced fragment
handling</p>
<dl class="py method">
<dt id="molsys.addon.fragments.fragments.analyze_frag_conn">
<code class="sig-name descname"><span class="pre">analyze_frag_conn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_atypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.analyze_frag_conn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.analyze_frag_conn" title="Permalink to this definition">¶</a></dt>
<dd><p>detect all types of inter-fragment bonds out of frag_conn and frag_conn_atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><ul class="simple">
<li><p>validator: a validator obejct that validates a frag connection</p></li>
<li><p>reset_atypes (boolean): if True the fragment name (or the merged fragment name) will be appended to the atype</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.check">
<code class="sig-name descname"><span class="pre">check</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.check" title="Permalink to this definition">¶</a></dt>
<dd><p>check if all atoms are in a fragment and all is consistent</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.frags2atoms">
<code class="sig-name descname"><span class="pre">frags2atoms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.frags2atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.frags2atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.get_fragnames">
<code class="sig-name descname"><span class="pre">get_fragnames</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.get_fragnames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.get_fragnames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.get_occurence_of_frag">
<code class="sig-name descname"><span class="pre">get_occurence_of_frag</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.get_occurence_of_frag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.get_occurence_of_frag" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the fragment count of the fragment with the given name</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.make_frag_conn">
<code class="sig-name descname"><span class="pre">make_frag_conn</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.make_frag_conn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.make_frag_conn" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a fragment connectivity</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.make_frag_graph">
<code class="sig-name descname"><span class="pre">make_frag_graph</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.make_frag_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.make_frag_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a graph of the frag_conn in analogy to the graph addon on the molecular level
using the graph addons util_graph method</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.plot_frag_graph">
<code class="sig-name descname"><span class="pre">plot_frag_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.plot_frag_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.plot_frag_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.fragments.fragments.upgrade">
<code class="sig-name descname"><span class="pre">upgrade</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">se</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/fragments.html#fragments.upgrade"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.fragments.fragments.upgrade" title="Permalink to this definition">¶</a></dt>
<dd><p>upgrades the vertex labels in a frag graph
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>se  (str): vertex label to be replaced</p></li>
<li><p>rep (str): new vertex label</p></li>
<li><p>rep_n (int): optional. the amount of vertices to be replaced</p></li>
</ul>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molsys.addon.graph">
<span id="molsys-addon-graph-module"></span><h2><span class="section-number">1.1.1.1.1.6. </span>molsys.addon.graph module<a class="headerlink" href="#module-molsys.addon.graph" title="Permalink to this headline">¶</a></h2>
<p>module to implement an addon feature: graphs using the graph_tool library</p>
<p>NOTE: this is only imported by __init__.py if graph_tool is present</p>
<dl class="py class">
<dt id="molsys.addon.graph.graph">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.graph.</span></code><code class="sig-name descname"><span class="pre">graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.graph.graph.check_sub">
<code class="sig-name descname"><span class="pre">check_sub</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.check_sub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.check_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>check if subg found in self.graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subg</strong> (<em>mol.graph objects</em>) – subgraph to be tested</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.decompose">
<code class="sig-name descname"><span class="pre">decompose</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ringsize'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_organic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.decompose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.decompose" title="Permalink to this definition">¶</a></dt>
<dd><p>decompose the molecular graph into BBs and the underlying net</p>
<p>There are different strategies to split the graph into parts and also the returned information
can be tuned.
In general, a topo mol object of the underlying net and a set of BB mol objects with a mapping
to vertices and edges will be returned.</p>
<dl class="simple">
<dt>modes:</dt><dd><p>ringsize: use clusters of minimum ring size as used by Topos for decomposition</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – mode of splitting into BBs. Defaults to “ringsize”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.detect_interp">
<code class="sig-name descname"><span class="pre">detect_interp</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.detect_interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.detect_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>This method helps to identify interpenetration and remaining solvent</p>
<p>use bb vertex property to do the component analysis of the unsplit moldg
==&gt; if we have more than one compnent then there are three options:</p>
<blockquote>
<div><ul class="simple">
<li><p>the system is interpenetrated</p></li>
<li><p>the system contains unconnected solvent</p></li>
<li><p>something went wrong with the connectivity detection</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.filter_graph">
<code class="sig-name descname"><span class="pre">filter_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.filter_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.filter_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>filters all atoms besides the given out of the graph
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>idx (list): indices of atoms to keep</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.find_fragment">
<code class="sig-name descname"><span class="pre">find_fragment</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.find_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.find_fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>find a complete fragment (including the hydrogen atoms not included in the graph)
Note that the fragment found can be different from the fragment by the number of hydrogen atoms!!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><ul class="simple">
<li><p>frag : mol object with graph addon to be found</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of lists with the atom indices of the fragment in the full system</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.find_sub">
<code class="sig-name descname"><span class="pre">find_sub</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.find_sub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.find_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>use graph_tools subgraph_isomorphism tool to find substructures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><ul class="simple">
<li><p>subg : graph object (from another molsys) to be searched</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of lists with the (sorted) vertex indices of the substructure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.find_subgraph">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">find_subgraph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_property</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subg_property</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.find_subgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.find_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>use graph_tools subgraph_isomorphism tool to find substructures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><ul class="simple">
<li><p>graph : parent graph to be searched</p></li>
<li><p>subg  : graph to be found</p></li>
<li><p>N (int): number of subgraphs to find, N=0 is all (defaults to N=0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of lists with the (sorted) vertex indices of the substructure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.get_bbs">
<code class="sig-name descname"><span class="pre">get_bbs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_mfpx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.get_bbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.get_bbs" title="Permalink to this definition">¶</a></dt>
<dd><p>this method generates the unique bbs from moldg and bbg</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.get_components">
<code class="sig-name descname"><span class="pre">get_components</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fidx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.get_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.get_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the components aka molecules from the atomic graph</p>
<p>it adds a property map molid to the graph</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of components found</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.get_net">
<code class="sig-name descname"><span class="pre">get_net</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.get_net"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.get_net" title="Permalink to this definition">¶</a></dt>
<dd><p>this method takes a sliced moldg and creates a graph of the underlying net</p>
<dl class="simple">
<dt>TBI: currently no pconn is detected .. we rely on being able to construct it from the embedding</dt><dd><p>this needs to be tested for very small thigs like a 1x1x1 pcu based MOF</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>otional</em>) – Defaults to “coc”, mode how to compute the position of the BBs vertex position
coc - center of connectors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.is_equal">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">is_equal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molg1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fast_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.is_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.is_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to identify if two molecular graphs are equal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molg1</strong> (<em>molecular graph</em>) – molecular graph to be compared to molg2</p></li>
<li><p><strong>molg2</strong> (<em>molecular graph</em>) – molecular graph to be compared to molg1</p></li>
<li><p><strong>use_fast_check</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – will enforce a fast check based on the similarity rather than a graph isomorphisim</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.join_2c">
<code class="sig-name descname"><span class="pre">join_2c</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.join_2c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.join_2c" title="Permalink to this definition">¶</a></dt>
<dd><p>this method combines all 2c BBs into one, needs bbg but a call to make_bbg_graph has to be repeated</p>
<p>returns a flag which is True if a merge happend</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.join_organic">
<code class="sig-name descname"><span class="pre">join_organic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.join_organic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.join_organic" title="Permalink to this definition">¶</a></dt>
<dd><p>this method combines organic BBs into one (be it edges or vertices)</p>
<p>returns a flag which is True if a merge happened and make_bbg_graph needs to be rerun</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.make_bb_graph">
<code class="sig-name descname"><span class="pre">make_bb_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.make_bb_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.make_bb_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.make_comp_graph">
<code class="sig-name descname"><span class="pre">make_comp_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['c']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.make_comp_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.make_comp_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Like make_graph this creates a graph for the mol object, but here we focus on a graph
for comparing molecular species in reactions. In the current graph we only look at the C-graph</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.make_decomp_graph">
<code class="sig-name descname"><span class="pre">make_decomp_graph</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.make_decomp_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.make_decomp_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>make a mol graph for decomposition</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.make_graph">
<code class="sig-name descname"><span class="pre">make_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.make_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.make_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a graph for the mol object (atoms should be typed)
we use the atomtype name with the “_” and everything after it (rule=2) truncated.
in other words the vertex property is the element plus the coordination number</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.plot_graph">
<code class="sig-name descname"><span class="pre">plot_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'arf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.plot_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.plot_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>plot the graph (needs more tuning options) [via <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs? RA]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><ul class="simple">
<li><p>fname  : filename (will write filename.pdf)</p></li>
<li><p>size   : outputsize will be (size, size) in px [default 800]</p></li>
<li><p>fsize  : font size [default 10]</p></li>
<li><dl class="simple">
<dt>method<span class="classifier">placement method to draw graph, can be one of</span></dt><dd><p>arf
frucht
radtree
sfdp
random</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.plot_mol_graph">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">plot_mol_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'arf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.plot_mol_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.plot_mol_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>plot the graph (needs more tuning options) [via <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs? RA]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameter</dt>
<dd class="field-odd"><ul class="simple">
<li><p>fname  : filename (will write filename.pdf)</p></li>
<li><p>size   : outputsize will be (size, size) in px [default 800]</p></li>
<li><p>fsize  : font size [default 10]</p></li>
<li><dl class="simple">
<dt>method<span class="classifier">placement method to draw graph, can be one of</span></dt><dd><p>arf
frucht
radtree
sfdp
random</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.split_ringsize">
<code class="sig-name descname"><span class="pre">split_ringsize</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.split_ringsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.split_ringsize" title="Permalink to this definition">¶</a></dt>
<dd><p>split by determining ringsizes follwoing the topos strategy</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.unfilter_graph">
<code class="sig-name descname"><span class="pre">unfilter_graph</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.unfilter_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.unfilter_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.graph.graph.util_graph">
<code class="sig-name descname"><span class="pre">util_graph</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vtypes2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/graph.html#graph.util_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.graph.graph.util_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a graph with vertices and connectivity in conn</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-molsys.addon.molecules">
<span id="molsys-addon-molecules-module"></span><h2><span class="section-number">1.1.1.1.1.7. </span>molsys.addon.molecules module<a class="headerlink" href="#module-molsys.addon.molecules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-molsys.addon.ric">
<span id="molsys-addon-ric-module"></span><h2><span class="section-number">1.1.1.1.1.8. </span>molsys.addon.ric module<a class="headerlink" href="#module-molsys.addon.ric" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="molsys-addon-spg-module">
<h2><span class="section-number">1.1.1.1.1.9. </span>molsys.addon.spg module<a class="headerlink" href="#molsys-addon-spg-module" title="Permalink to this headline">¶</a></h2>
<p>Created on Wed Dec  7 15:44:36 2016</p>
<p>&#64;author: rochus</p>
<dl class="py function">
<dt id="molsys.addon.spg.get_frac_match">
<code class="sig-prename descclassname"><span class="pre">molsys.addon.spg.</span></code><code class="sig-name descname"><span class="pre">get_frac_match</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#get_frac_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.get_frac_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="molsys.addon.spg.spg">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.spg.</span></code><code class="sig-name descname"><span class="pre">spg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.spg.spg.cif_connectivity">
<code class="sig-name descname"><span class="pre">cif_connectivity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atypes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.cif_connectivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.cif_connectivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.cif_connectivity_alternative">
<code class="sig-name descname"><span class="pre">cif_connectivity_alternative</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.cif_connectivity_alternative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.cif_connectivity_alternative" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.equivalent_sites">
<code class="sig-name descname"><span class="pre">equivalent_sites</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaled_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onduplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'error'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.equivalent_sites"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.equivalent_sites" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns the scaled positions and all their equivalent sites.</dt><dd><p>Shamelessly and gratefully copied from ase.spacegroup</p>
</dd>
</dl>
<p>Parameters:</p>
<dl>
<dt>scaled_positions: list | array</dt><dd><p>List of non-equivalent sites given in unit cell coordinates.</p>
</dd>
<dt>onduplicates<span class="classifier">‘keep’ | ‘replace’ | ‘warn’ | ‘error’</span></dt><dd><p>Action if <cite>scaled_positions</cite> contain symmetry-equivalent
positions:</p>
<dl class="simple">
<dt>‘keep’</dt><dd><p>ignore additional symmetry-equivalent positions</p>
</dd>
<dt>‘replace’</dt><dd><p>replace</p>
</dd>
<dt>‘warn’</dt><dd><p>like ‘keep’, but issue an UserWarning</p>
</dd>
<dt>‘error’</dt><dd><p>raises a SpacegroupValueError</p>
</dd>
</dl>
</dd>
<dt>symprec: float</dt><dd><p>Minimum “distance” betweed two sites in scaled coordinates
before they are counted as the same site.</p>
</dd>
</dl>
<p>Returns:</p>
<dl class="simple">
<dt>sites: array</dt><dd><p>A NumPy array of equivalent sites.</p>
</dd>
<dt>kinds: list</dt><dd><p>A list of integer indices specifying which input site is
equivalent to the corresponding returned site.</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ase.spacegroup</span> <span class="kn">import</span> <span class="n">Spacegroup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span> <span class="o">=</span> <span class="n">Spacegroup</span><span class="p">(</span><span class="mi">225</span><span class="p">)</span>  <span class="c1"># fcc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sites</span><span class="p">,</span> <span class="n">kinds</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">equivalent_sites</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sites</span>
<span class="go">array([[ 0. ,  0. ,  0. ],</span>
<span class="go">       [ 0. ,  0.5,  0.5],</span>
<span class="go">       [ 0.5,  0. ,  0.5],</span>
<span class="go">       [ 0.5,  0.5,  0. ],</span>
<span class="go">       [ 0.5,  0. ,  0. ],</span>
<span class="go">       [ 0. ,  0.5,  0. ],</span>
<span class="go">       [ 0. ,  0. ,  0.5],</span>
<span class="go">       [ 0.5,  0.5,  0.5]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kinds</span>
<span class="go">[0, 0, 0, 0, 1, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.find_symmetry">
<code class="sig-name descname"><span class="pre">find_symmetry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyzref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.find_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.find_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>If a match is found, return True. Else, return False.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.find_symmetry_from_colors">
<code class="sig-name descname"><span class="pre">find_symmetry_from_colors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symperms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.find_symmetry_from_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.find_symmetry_from_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>If a match is found, return True. Else, return False.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.find_symmetry_from_frac">
<code class="sig-name descname"><span class="pre">find_symmetry_from_frac</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fracref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.find_symmetry_from_frac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.find_symmetry_from_frac" title="Permalink to this definition">¶</a></dt>
<dd><p>If a match is found, return True. Else, return False.
N.B.:
self.find_symmetry_from_colors(sel.colors[m.spg.symperms[i]],symperms=self.symperms) == i</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.generate_spgcell">
<code class="sig-name descname"><span class="pre">generate_spgcell</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.generate_spgcell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.generate_spgcell" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the spglib specific representation of the structure
(Needs to be called before any other call to spg methods)</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>omit : a list of either integers (atomic numbers) or element strings to be omited [optional]</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.generate_symmetries">
<code class="sig-name descname"><span class="pre">generate_symmetries</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.generate_symmetries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.generate_symmetries" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate list of coordinates by symmetries
scale (same scale as per supercell) ###TBI: non-orthorombic cells</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.generate_symmetry_dataset">
<code class="sig-name descname"><span class="pre">generate_symmetry_dataset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-13</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.generate_symmetry_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.generate_symmetry_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the data necessary to exploit symmetry within weaver.
transformations in the end contains a set of rotations and translations
for every vertex.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.generate_symperms">
<code class="sig-name descname"><span class="pre">generate_symperms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.generate_symperms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.generate_symperms" title="Permalink to this definition">¶</a></dt>
<dd><p>Each symmetry permutation stores the indices that would sort an array
according to each symmetry operation in the symmetry space group.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">addon</span><span class="p">(</span><span class="s1">&#39;spg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">spg</span><span class="o">.</span><span class="n">generate_spgcell</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">spg</span><span class="o">.</span><span class="n">generate_symmetries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">spg</span><span class="o">.</span><span class="n">generate_symperms</span><span class="p">()</span>
</pre></div>
</div>
<p>### OLD LOOP IMPLEMENTATION ###
&gt;&gt;&gt; for i,isym in enumerate(self.syms):
&gt;&gt;&gt;     symperm = []
&gt;&gt;&gt;     for c in isym:
&gt;&gt;&gt;         frac -= c
&gt;&gt;&gt;         fracadd = abs(frac)+.5
&gt;&gt;&gt;         gap = (abs(fracadd-np.floor(fracadd)-.5) &lt; eps)
&gt;&gt;&gt;         sype = np.where(gap.all(axis=1))[0][0]
&gt;&gt;&gt;         symperm.append(sype)
it is slow with respect to the broadcasting</p>
<p>N.B. to avoid that -0. = 0 an older implementation used np.isclose to substitute 0/1 floats to exact 0/1 integers</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.get_frac_match">
<code class="sig-name descname"><span class="pre">get_frac_match</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sym</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.get_frac_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.get_frac_match" title="Permalink to this definition">¶</a></dt>
<dd><p>retrieve equivalent</p>
<p>[description]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>{</strong> (<em>sym</em>) – </p></li>
<li><p><strong>{</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>{</strong><strong>[</strong><strong>type</strong><strong>]</strong><strong>} --</strong><strong> [</strong><strong>description</strong><strong>] </strong><strong>(</strong><strong>default</strong> (<em>eps</em>) – {5e-6})</p></li>
<li><p><strong>{</strong><strong>[</strong><strong>type</strong><strong>]</strong><strong>} --</strong><strong> [</strong><strong>description</strong><strong>] </strong><strong>(</strong><strong>default</strong> – {1e-8})</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[type] – [description]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.get_primitive_cell">
<code class="sig-name descname"><span class="pre">get_primitive_cell</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.get_primitive_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.get_primitive_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>get the primitve cell as a new mol object</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.get_spacegroup">
<code class="sig-name descname"><span class="pre">get_spacegroup</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.get_spacegroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.get_spacegroup" title="Permalink to this definition">¶</a></dt>
<dd><p>determine the space group of the current system
returns a tuple with the symbol and the integer number</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.get_symmetry">
<code class="sig-name descname"><span class="pre">get_symmetry</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.get_symmetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.get_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>returns lists of rotations, translations and equivalent atoms according to the spgcell
n.b.: spgcell must be generated with generate_spgcell
example:
&gt;&gt;&gt; import molsys
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; m = molsys.mol()
&gt;&gt;&gt; m.read(filename)
&gt;&gt;&gt; m.addon(“spg”)
&gt;&gt;&gt; m.spg.generate_spgcell()
&gt;&gt;&gt; sym = m.spg.get_symmetry()
&gt;&gt;&gt; n=0 #just an example, n could be any btw. 0 and len(sym)-1
&gt;&gt;&gt; rota, tran = sym[‘rotations’][n], sym[‘translations’][n]
&gt;&gt;&gt; new_vector = rota*old_vector[:,np.newaxis] + tran</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.get_symprec">
<code class="sig-name descname"><span class="pre">get_symprec</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.get_symprec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.get_symprec" title="Permalink to this definition">¶</a></dt>
<dd><p>get the symmetry threshold</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.make_P1">
<code class="sig-name descname"><span class="pre">make_P1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spgnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sg_setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onduplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.make_P1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.make_P1" title="Permalink to this definition">¶</a></dt>
<dd><p>to be implemented by Julian from his topo tools</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>spgnum : integer space group number</p></li>
</ul>
</dd>
<dt class="field-even">KNOWN BUGS</dt>
<dd class="field-even"><ul class="simple">
<li><p>scaled_positions could be equivalent from a cif file, so it fails to make_P1</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.spg.spg.set_symprec">
<code class="sig-name descname"><span class="pre">set_symprec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/molsys/addon/spg.html#spg.set_symprec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#molsys.addon.spg.spg.set_symprec" title="Permalink to this definition">¶</a></dt>
<dd><p>set the symmetry threshold</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="molsys-addon-zmat-module">
<h2><span class="section-number">1.1.1.1.1.10. </span>molsys.addon.zmat module<a class="headerlink" href="#molsys-addon-zmat-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-molsys.addon">
<span id="module-contents"></span><h2><span class="section-number">1.1.1.1.1.11. </span>Module contents<a class="headerlink" href="#module-molsys.addon" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="molsys.addon.acab">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">acab</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#molsys.addon.base.base" title="molsys.addon.base.base"><code class="xref py py-class docutils literal notranslate"><span class="pre">base.base</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.acab.assert_ecolors">
<code class="sig-name descname"><span class="pre">assert_ecolors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_ecolors" title="Permalink to this definition">¶</a></dt>
<dd><p>Check length of edge colors</p>
<p>ecolors (list of ints): edge colors</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_ecratio">
<code class="sig-name descname"><span class="pre">assert_ecratio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecratio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_ecratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Check edge color ratio
The ratio must be an iterable of numbers with the same length as</p>
<blockquote>
<div><p>number of edge colors</p>
</div></blockquote>
<p>ecratio (iterable): edge color ratio</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_flag">
<code class="sig-name descname"><span class="pre">assert_flag</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if flag is boolean</p>
<p>flag (object): instance to be checked</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_hasmodel">
<code class="sig-name descname"><span class="pre">assert_hasmodel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_hasmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if model is setup in acab</p>
<p>TBI: when edge model and vertex model will be separated (here for future)</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_loop_alpha">
<code class="sig-name descname"><span class="pre">assert_loop_alpha</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_loop_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Check alpha order of edge quantile</p>
<p>alpha (float): alpha</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_loop_edge">
<code class="sig-name descname"><span class="pre">assert_loop_edge</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr_edge</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_loop_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_loop_vertex">
<code class="sig-name descname"><span class="pre">assert_loop_vertex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_vertex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr_vertex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_loop_vertex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_ncolors_number">
<code class="sig-name descname"><span class="pre">assert_ncolors_number</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncolors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_ncolors_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Check non-negative number of colors</p>
<p>ncolors (int): number of colors
strict=False (bool): strict mode</p>
<blockquote>
<div><p>if True, ncolors must be positive (0 is not allowed)
if False, ncolors must be non-negative (0 is allowed)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_nevcolors_number">
<code class="sig-name descname"><span class="pre">assert_nevcolors_number</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">necolors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nvcolors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_nevcolors_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Check non-negative number of edge colors and vertex colors. At least
one must be positive</p>
<p>necolors (int): number of edge colors
nvcolors (int): number of vertex colors</p>
<dl class="simple">
<dt>Used when numbers of both edge colors and vertex colors are set with</dt><dd><p>the same method</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_oconn">
<code class="sig-name descname"><span class="pre">assert_oconn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oconn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_oconn" title="Permalink to this definition">¶</a></dt>
<dd><p>Check length of color connectivity # VERTEX COLORS</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_otab">
<code class="sig-name descname"><span class="pre">assert_otab</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">otab</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_otab" title="Permalink to this definition">¶</a></dt>
<dd><p>Check length of color table # EDGE COLORS</p>
<p>otab (list of integers): color table to be compared against edge table</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_vcolors">
<code class="sig-name descname"><span class="pre">assert_vcolors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcolors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_vcolors" title="Permalink to this definition">¶</a></dt>
<dd><p>Check length of vertex colors</p>
<p>vcolors (list of ints): vertex colors</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.assert_vcratio">
<code class="sig-name descname"><span class="pre">assert_vcratio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcratio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.assert_vcratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Check vertex color ratio
The ratio must be an iterable of numbers with the same length as</p>
<blockquote>
<div><p>number of vertex colors</p>
</div></blockquote>
<p>vcratio (iterable): vertex color ratio</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_constraint">
<code class="sig-name descname"><span class="pre">cycle_constraint</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_constraint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_init">
<code class="sig-name descname"><span class="pre">cycle_init</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_init" title="Permalink to this definition">¶</a></dt>
<dd><p>initialize symmetry</p>
<p>Any symmetry solution subspace belongs to the symmetry space and the
subspaces does not overlap each other. In other words, symmetry
solution subspaces make a partition of the symmetry solution space.</p>
<dl class="field-list simple">
<dt class="field-odd">TODO</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>disable symmetry</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_initdir">
<code class="sig-name descname"><span class="pre">cycle_initdir</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_initdir" title="Permalink to this definition">¶</a></dt>
<dd><p>create directory to store structures at the end of the loop
“colors” and “pretty” contains graph-like structures
“colors” contains useful structures to weave frameworks later
“pretty” contains just clearer views of these structures (do not use)
“plain” contains clearer views in plain tinker format (do not use)</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_initsym">
<code class="sig-name descname"><span class="pre">cycle_initsym</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_initsym" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_loop">
<code class="sig-name descname"><span class="pre">cycle_loop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_sym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_sym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_vertex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constr_vertex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_equivalence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rundir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'run'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newrundir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>cycle model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>Nmax=10.000 (int): maximum number of iterations</p></li>
<li><p>alpha=3 (int): edge <a href="#id5"><span class="problematic" id="id6">``</span></a>quantile’’ order (see Notes)</p></li>
<li><p>init_sym (bool):</p></li>
<li><p>span_sym (bool):</p></li>
<li><p>use_edge (bool):</p></li>
<li><p>use_vertex (bool):</p></li>
<li><p>constr_edge (bool):</p></li>
<li><p>constr_vertex (bool):</p></li>
<li><p>color_equivalence (None or dict):</p></li>
<li><p>rundir=”rundir” (str):</p></li>
<li><p>newrundir (bool):</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>N (int): number of iterations</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>N (int): abs(N)=number of solutions</p></li>
</ul>
<p>if N &gt; 0: EXACT number of solutions (exhaustiveness)
if N &lt; 0: MINIMUM number of solutions (there may be others)</p>
<dl class="field-list simple">
<dt class="field-odd">Notes</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<dl>
<dt>alpha: for space group symmetry detection, each edge is represented as</dt><dd><p>additional atoms in the between of the source vertex and target
vertex.
If alpha == 2:</p>
<blockquote>
<div><p>ONE edge atom is put in the centroid of the two vertices</p>
</div></blockquote>
<dl>
<dt>If alpha &gt;= 3:</dt><dd><p>TWO edge atoms are put in the between of the two vertices as follows:
1- Bond segment is divided in <a href="#id7"><span class="problematic" id="id8">``</span></a>alpha’’ equal parts by alpha-1 points</p>
<blockquote>
<div><p>between the vertices</p>
</div></blockquote>
<dl class="simple">
<dt>2- The edge atoms lie on the points closest to the vertices, i.e. the</dt><dd><p>first and the (alpha-1)-th</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_permute">
<code class="sig-name descname"><span class="pre">cycle_permute</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_permute" title="Permalink to this definition">¶</a></dt>
<dd><p>symmetrize solution according to symmetry permutations</p>
<p>symmetrize the solution of the optimal model in its symmetry solution
subspace.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.cycle_step">
<code class="sig-name descname"><span class="pre">cycle_step</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.cycle_step" title="Permalink to this definition">¶</a></dt>
<dd><p>step to cycle the model until infeasibility
the model is optimized, then the new solution/its subspace is set
as additional negated constraint to the next cycle
constraints of the previous set (the “original” constraints )are kept
“freeing the transformation” of the model (cf. SCIP)</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.debug_">
<code class="sig-name descname"><span class="pre">debug_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.debug_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.download_">
<code class="sig-name descname"><span class="pre">download_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.download_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.exclude_edge_solution">
<code class="sig-name descname"><span class="pre">exclude_edge_solution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.exclude_edge_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.exclude_vertex_solution">
<code class="sig-name descname"><span class="pre">exclude_vertex_solution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.exclude_vertex_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.filter_cycle">
<code class="sig-name descname"><span class="pre">filter_cycle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.filter_cycle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.find_">
<code class="sig-name descname"><span class="pre">find_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.find_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.free_model">
<code class="sig-name descname"><span class="pre">free_model</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.free_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_colors">
<code class="sig-name descname"><span class="pre">get_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_constant_naming">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_constant_naming</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naming</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dummy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_constant_naming" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method to get constant naming for colored net structures
This part of naming is the same for any of the found solutions</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>m (mol): mol object that stores the coloring</p></li>
<li><p>N=1 (int): total number of found solutions</p></li>
<li><p>naming=”dummy” (str): naming scheme to be used (see comments below)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>fmtsx (str): format string at the left side of the constraint labels</p></li>
<li><p>fmtdx (str): format string at the right side of the constraint labels</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_edge_colors">
<code class="sig-name descname"><span class="pre">get_edge_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_edge_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_edge_vars">
<code class="sig-name descname"><span class="pre">get_edge_vars</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_edge_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_variable_naming">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">get_variable_naming</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naming</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dummy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_variable_naming" title="Permalink to this definition">¶</a></dt>
<dd><p>Static method to get variable naming for colored net structures
This part of naming is ensured to be different for any of the found solutions</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>m (mol): mol object that stores the coloring</p></li>
<li><p>j=0 (int): running solution index tracking the order of finding</p></li>
<li><p>N=1 (int): total number of found solutions</p></li>
<li><p>naming=”dummy” (str): naming scheme to be used (see comments below)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>different returns (see comments below)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_vertex_colors">
<code class="sig-name descname"><span class="pre">get_vertex_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_vertex_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.get_vertex_vars">
<code class="sig-name descname"><span class="pre">get_vertex_vars</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.get_vertex_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.include_edge_solution">
<code class="sig-name descname"><span class="pre">include_edge_solution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.include_edge_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.include_vertex_solution">
<code class="sig-name descname"><span class="pre">include_vertex_solution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.include_vertex_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.is_optimal_model">
<code class="sig-name descname"><span class="pre">is_optimal_model</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.is_optimal_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.make_structure">
<code class="sig-name descname"><span class="pre">make_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.make_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Make structures out of edge colors and vertex colors</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>ecolors:</p></li>
<li><p>vcolors:</p></li>
<li><p>alpha=2 (int):</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.negate_edge_constraints">
<code class="sig-name descname"><span class="pre">negate_edge_constraints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.negate_edge_constraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.negate_vertex_constraints">
<code class="sig-name descname"><span class="pre">negate_vertex_constraints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.negate_vertex_constraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.optimize_model">
<code class="sig-name descname"><span class="pre">optimize_model</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.optimize_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.read_">
<code class="sig-name descname"><span class="pre">read_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.read_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_colors">
<code class="sig-name descname"><span class="pre">report_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_cycle">
<code class="sig-name descname"><span class="pre">report_cycle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_cycle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_edge_colors">
<code class="sig-name descname"><span class="pre">report_edge_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_edge_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_edge_values">
<code class="sig-name descname"><span class="pre">report_edge_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_edge_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_last">
<code class="sig-name descname"><span class="pre">report_last</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_last" title="Permalink to this definition">¶</a></dt>
<dd><p>report last cycle status</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>i (int): loop index (if None prints None)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_step">
<code class="sig-name descname"><span class="pre">report_step</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_values">
<code class="sig-name descname"><span class="pre">report_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_vertex_colors">
<code class="sig-name descname"><span class="pre">report_vertex_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_vertex_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.report_vertex_values">
<code class="sig-name descname"><span class="pre">report_vertex_values</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.report_vertex_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.set_colors">
<code class="sig-name descname"><span class="pre">set_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.set_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>to be called after model optimization</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.set_edge_colors">
<code class="sig-name descname"><span class="pre">set_edge_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.set_edge_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.set_edge_vars">
<code class="sig-name descname"><span class="pre">set_edge_vars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">necolors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_necolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.set_edge_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.set_structures_from_colorings">
<code class="sig-name descname"><span class="pre">set_structures_from_colorings</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.set_structures_from_colorings" title="Permalink to this definition">¶</a></dt>
<dd><p>Set colored net structures from (edge and vertex) colorings
Structures are stored in <cite>structures</cite> list attribute as mol instances</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.set_vertex_colors">
<code class="sig-name descname"><span class="pre">set_vertex_colors</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.set_vertex_colors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.set_vertex_vars">
<code class="sig-name descname"><span class="pre">set_vertex_vars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nvcolors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_nvcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.set_vertex_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_angle_btw_edges">
<code class="sig-name descname"><span class="pre">setup_angle_btw_edges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sense</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsele</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_angle_btw_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Constraint angle between edges to be min/max/close to theta.
TBI: non-periodic (w/o pconn) version</p>
<p>IMPLEMENTATION DETAIL
Instead of explicitly allowing the edge pairs with (range of) angle, it
forbids the opposite, i.e. edge pairs that do not form/match that angle
This is easier wrt. integer programming: if edge j and edge k form a
forbidden angle, then the sum of the edge variabes must be 1 or lower,
i.e. their colors can’t be the same.</p>
<p>color(int): constraint color (order based on ratio assignment)
theta(float): angle btw. 0 and pi
sense(str): sense of constraint [TBI: custom tolerances]</p>
<blockquote>
<div><p>min:   allowed product btw. edges must be &gt;  cos(theta)
max:   allowed product btw. edges must be &lt;  cos(theta)
close: allowed product btw. edges must be =~ cos(theta)
N.B. theta from 0 to PI and cosine(theta) are antitone mapped,</p>
<blockquote>
<div><p>so min(theta) -&gt; max(cos(theta))</p>
</div></blockquote>
</div></blockquote>
<p>eps(float): tolerance to sense
sele (list of ints or None): selected vertices (if None: all)</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_colors">
<code class="sig-name descname"><span class="pre">setup_colors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">necolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nvcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>setup number of edge colors and/or vertex colors.
if the number of colors is more than zero, the appropriate edge/vertex</p>
<blockquote>
<div><p>variable setter is called</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>necolors (int): number of max edge colors</p></li>
<li><p>nvcolors (int): number of max vertex colors</p></li>
</ul>
<p>N.B. necolors and nvcolors cannot be:
- negative (no sense)
- BOTH zero (why would you ever need a model at all? just set them with</p>
<blockquote>
<div><p>setters or (e.g.) with &lt;yourinstance&gt;.necolors = colors</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_constraints">
<code class="sig-name descname"><span class="pre">setup_constraints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED / TBI</p>
<p>general interface to setup constraints of the model.
TBI: additional constraints can be set, see tutorial [TBI, easy]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>ecratio (None or list of ints): overall edge   color ratio</p></li>
<li><p>vcratio (None or list of ints): overall vertex color ratio</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_ecolors">
<code class="sig-name descname"><span class="pre">setup_ecolors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">necolors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_ecolors" title="Permalink to this definition">¶</a></dt>
<dd><p>setup number of edge colors
if the number of edge colors is more than zero, the appropriate edge</p>
<blockquote>
<div><p>variable setter is called</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>necolors (int): number of max edge colors</p></li>
</ul>
<p>N.B. it must be positive</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_ecratio">
<code class="sig-name descname"><span class="pre">setup_ecratio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsele</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_ecratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_ecratio" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>ecratio (None or list of ints): overall edge color ratio</p></li>
</ul>
<p>TBI: unset ratio with negative integers (convention: -1) and reserve
the complement of the set elements
TBI: select atoms which the setup is applied! [JK feature request]</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_ecratio_per_vertex">
<code class="sig-name descname"><span class="pre">setup_ecratio_per_vertex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsele</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_ecratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_ecratio_per_vertex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_edge2vertices">
<code class="sig-name descname"><span class="pre">setup_edge2vertices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sort_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_edge2vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>setup dictionary from edges to list of vertices (convenience)
keys are (i,j,p) tuples and values are list of integers
where i,j,p are atom i, atom j, and periodic image index respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>sort_flag (bool=True): if True: sorts lists of variables according to</dt><dd><p>names of variables</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_edge2vvars">
<code class="sig-name descname"><span class="pre">setup_edge2vvars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sort_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_edge2vvars" title="Permalink to this definition">¶</a></dt>
<dd><p>setup dictionary from edges to list of vertex variables (convenience)
keys are (i,j,p) tuples and values are list of SCIP variables
where i,j,p are atom i, atom j, and periodic image index respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>sort_flag (bool=True): if True: sorts lists of variables according to</dt><dd><p>names of variables</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_model">
<code class="sig-name descname"><span class="pre">setup_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrlc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the model and its utility attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>verbose (bool=True): output flag for model instance</p></li>
<li><dl class="simple">
<dt>ctrlc (bool=True): experts’ flag to en/disable default</dt><dd><p>KeyboardInterrupt handling</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Additional Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>args: positional arguments of Model.__init__ (cf. Model)</p></li>
<li><p>kwargs:  keyword arguments of Model.__init__ (cf. Model)</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Caveat</dt>
<dd class="field-odd"><dl>
<dt>ctrlc == False:</dt><dd><ul class="simple">
<li><p>implement a KeyboardInterrupt handler of your own!</p></li>
</ul>
<p>in case of emergency:
- open a shell
- ps aux | grep python
- find the PID of your script
- kill &lt;yourscript-PID&gt;</p>
</dd>
</dl>
</dd>
<dt class="field-even">Toughts</dt>
<dd class="field-even"><p></p></dd>
</dl>
<ul class="simple">
<li><p>separate edge model and vertex model! (emodel vs vmodel)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_vcolors">
<code class="sig-name descname"><span class="pre">setup_vcolors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nvcolors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_vcolors" title="Permalink to this definition">¶</a></dt>
<dd><p>setup number of vertex colors
if the number of vertex colors is more than zero, the appropriate vertex</p>
<blockquote>
<div><p>variable setter is called</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>nvcolors (int): number of max vertex colors</p></li>
</ul>
<p>N.B. it must be positive</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_vcratio">
<code class="sig-name descname"><span class="pre">setup_vcratio</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsele</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_vcratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_vcratio" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>vcratio (None or list of ints): overall vertex color ratio</p></li>
</ul>
<p>TBI: unset ratio with negative integers (convention: -1) and reserve
the complement of the set elements without constraint but their total
sum.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_vcratio_per_edge">
<code class="sig-name descname"><span class="pre">setup_vcratio_per_edge</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esele</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_vcratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_vcratio_per_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>N.B.: there are always two vertices per edge</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_vertex2edges">
<code class="sig-name descname"><span class="pre">setup_vertex2edges</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sort_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_vertex2edges" title="Permalink to this definition">¶</a></dt>
<dd><p>setup dictionary from vertices to list of edges (convenience)
keys are integers and values are list of (i,j,p) tuples
where i,j,p are atom i, atom j, and periodic image index respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>sort_flag (bool=True): if True: sorts lists of variables according to</dt><dd><p>names of variables</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.setup_vertex2evars">
<code class="sig-name descname"><span class="pre">setup_vertex2evars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sort_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.setup_vertex2evars" title="Permalink to this definition">¶</a></dt>
<dd><p>setup dictionary from vertices to list of edge variables (convenience)
keys are integers and values are list of SCIP variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>sort_flag (bool=True): if True: sorts lists of variables according to</dt><dd><p>names of variables</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.test_">
<code class="sig-name descname"><span class="pre">test_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.test_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.upload_">
<code class="sig-name descname"><span class="pre">upload_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.upload_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.validate_edge_constraints">
<code class="sig-name descname"><span class="pre">validate_edge_constraints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.validate_edge_constraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.validate_vertex_constraints">
<code class="sig-name descname"><span class="pre">validate_vertex_constraints</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.validate_vertex_constraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.write_">
<code class="sig-name descname"><span class="pre">write_</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.write_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.acab.write_cycle">
<code class="sig-name descname"><span class="pre">write_cycle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naming</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dummy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.acab.write_cycle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.ff">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">ff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#molsys.addon.base.base" title="molsys.addon.base.base"><code class="xref py py-class docutils literal notranslate"><span class="pre">base.base</span></code></a></p>
<p>Class to administrate the FF parameters and to assign them.</p>
<p>The ff class is used to administrate the assignment of FF parameters
following our specific assignment approach and to vary the parameters
for FFgen runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molsys</strong> (<a class="reference internal" href="molsys.html#molsys.mol" title="molsys.mol"><em>molsys.mol</em></a>) – mol object for which parameters should be
assigned.</p>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>par(potentials): Defaults to None. External potentials object</dt><dd><p>which should be used in this ff class. Only needed for multistructure
fits with FFgen.</p>
</dd>
</dl>
</dd>
<dt>Attr:</dt><dd><p>ric_type()
par()
par_ind()</p>
</dd>
</dl>
<dl class="py method">
<dt id="molsys.addon.ff.assign_multi_params">
<code class="sig-name descname"><span class="pre">assign_multi_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FFs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refsysname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_atypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.assign_multi_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to orchestrate the parameter assignment for the current system using multiple force fields
defined in FFs by getting the corresponding data from the webAPI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>FFs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of strings containing the names of the FFs which should be assigned. Priority
is defined by the ordering of the list</p>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>refsysname</strong> (<a class="reference external" href="https://docs.python.org/3/library/string.html#module-string" title="(in Python v3.9)"><em>string</em></a>) – if set this is a refsystem leading to special
treatment of nonidentified params; defaults to None</p></li>
<li><p><strong>equivs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dictionary holding information on equivalences,
needed for parameterization processes in order to “downgrade” atomtpyes, defaults to
{}</p></li>
<li><p><strong>azone</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of indices defining the active zone, defaults to []</p></li>
<li><p><strong>special_atypes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – dict of special atypes, if empty special atypes from
mofplus are requested, defaults to {}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.assign_params">
<code class="sig-name descname"><span class="pre">assign_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refsysname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_atypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consecutive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ricdetect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poltypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.assign_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to orchestrate the parameter assignment for this system using a force field defined with
FF getting data from the webAPI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FF</strong> (<em>-</em>) – [string] name of the force field to be used in the parameter search</p></li>
<li><p><strong>verbose</strong> (<em>-</em>) – [integer, optional] print info on assignement process to logger;</p></li>
<li><p><strong>to 0</strong> (<em>defaults</em>) – </p></li>
<li><p><strong>refsysname</strong> (<em>-</em>) – [string, optional] if set this is a refsystem leading to special</p></li>
<li><p><strong>of nonidentified params; defaults to None</strong> (<em>treatment</em>) – </p></li>
<li><p><strong>equivs</strong> (<em>-</em>) – [dict, optional] dictionary holding information on equivalences,</p></li>
<li><p><strong>for parameterization processes in order to &quot;downgrade&quot; atomtpyes</strong> (<em>needed</em>) – </p></li>
<li><p><strong>to</strong> (<em>defaults</em>) – </p></li>
<li><p><strong>{}</strong> – </p></li>
<li><p><strong>azone</strong> (<em>-</em>) – [list, optional] list of indices defining the active zone;</p></li>
<li><p><strong>to</strong><strong> [</strong><strong>]</strong> (<em>defaults</em>) – </p></li>
<li><p><strong>special_atypes</strong> (<em>-</em>) – [dict, optional] dict of special atypes, if empty special atypes from</p></li>
<li><p><strong>are requested</strong> (<em>mofplus</em>) – </p></li>
<li><p><strong>to {}</strong> (<em>defaults</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.assign_params_from_key">
<code class="sig-name descname"><span class="pre">assign_params_from_key</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.assign_params_from_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used to setup an ff addon based on the legacy key file format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – filename of the key file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.assign_params_offline">
<code class="sig-name descname"><span class="pre">assign_params_offline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.assign_params_offline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.atoms_in_active">
<code class="sig-name descname"><span class="pre">atoms_in_active</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.atoms_in_active" title="Permalink to this definition">¶</a></dt>
<dd><p>this helper function checks if any atom (indices) in alist
appear in the list of active atoms (indices) in fsubsys</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alist</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of atom indices</p></li>
<li><p><strong>subsys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of atom indices</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True or False</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.atoms_in_subsys">
<code class="sig-name descname"><span class="pre">atoms_in_subsys</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsubsys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.atoms_in_subsys" title="Permalink to this definition">¶</a></dt>
<dd><p>this helper function checks if all fragments of atoms (indices) in alist
appear in the list of fragments (indices) in fsubsys
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>alist(list): list of atom indices</p></li>
<li><p>fsubsys(list): list of fragment indices</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><ul class="simple">
<li><p>True or False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.build_parname">
<code class="sig-name descname"><span class="pre">build_parname</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aftypes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.build_parname" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to build the parname out of the necessary information
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>ic(str): name of the internal coordinate</p></li>
<li><p>pot(str): pot name</p></li>
<li><p>ref(str): name of the reference system</p></li>
<li><p>aftypes(list): list of the involved aftypes</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><ul class="simple">
<li><p>parname</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.check_consistency">
<code class="sig-name descname"><span class="pre">check_consistency</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.check_consistency" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to check the consistency of the assigned parameters, if params are
missing an AssignmentError is raised.</p>
<dl class="simple">
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>generic(str): name of the FF which should be used as source for</dt><dd><p>the generic parameters, defaults to None</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.enumerate_types">
<code class="sig-name descname"><span class="pre">enumerate_types</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.enumerate_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to assign a number to the type, needed for fileIO</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.find_refsystems">
<code class="sig-name descname"><span class="pre">find_refsystems</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.find_refsystems" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>function to detect the reference systems:</dt><dd><ul class="simple">
<li><p>self.scan_ref      : list of ref names in the order to be searched</p></li>
<li><p>self.ref_systems   : dictionary of mol objects</p></li>
<li><p>self.ref_fraglist  : list of fragment indices belonging to this refsystem</p></li>
<li><p>self.ref_params    : paramtere dictionaries per refsystem (n-body/type)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.find_refsystems_new">
<code class="sig-name descname"><span class="pre">find_refsystems_new</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.find_refsystems_new" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>function to detect the reference systems:</dt><dd><ul class="simple">
<li><p>self.scan_ref      : list of ref names in the order to be searched</p></li>
<li><p>self.ref_systems   : dictionary of mol objects</p></li>
<li><p>self.ref_fraglist  : list of fragment indices belonging to this refsystem</p></li>
<li><p>self.ref_params    : paramtere dictionaries per refsystem (n-body/type)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.fix_bb13">
<code class="sig-name descname"><span class="pre">fix_bb13</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.fix_bb13" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to perform the fuxup for bb13 potentials</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.fix_strbnd">
<code class="sig-name descname"><span class="pre">fix_strbnd</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.fix_strbnd" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to perform the fixup for strbnd potentials</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.fixup_refsysparams">
<code class="sig-name descname"><span class="pre">fixup_refsysparams</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_ics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['bnd',</span> <span class="pre">'ang',</span> <span class="pre">'dih',</span> <span class="pre">'oop']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.fixup_refsysparams" title="Permalink to this definition">¶</a></dt>
<dd><p>Equivalent method to check consistency in the case that unknown parameters should
be determined eg. fitted. The Method prepares the internal data structures for
parameterization or sets default values for unkown params.
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>var_ics(list, optional): list of strings of internal coordinate names</p></li>
</ul>
<p>for which the fixup should be done, defaults to [“bnd”, “ang”, “dih”, “oop”]
- strbnd(bool, optional): switch for a forcing a fixup of strbnd terms, defauls to
False</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.get_parname">
<code class="sig-name descname"><span class="pre">get_parname</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.get_parname" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to produce the name string using the self.aftypes</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.get_parname_equiv">
<code class="sig-name descname"><span class="pre">get_parname_equiv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refsys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.get_parname_equiv" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to produce the name string using the self.aftypes
and the information in the self.equivs dictionary
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>alist(list): list of atom indices</p></li>
<li><p>ic(str): corresponding internal coordinate</p></li>
<li><p>refsys(str): corresponding name of reference system</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><ul class="simple">
<li><p>parname(str): parname</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.get_parname_sort">
<code class="sig-name descname"><span class="pre">get_parname_sort</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.get_parname_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to produce the name string using the self.aftypes</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.load_params_from_parfile">
<code class="sig-name descname"><span class="pre">load_params_from_parfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.load_params_from_parfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.pack">
<code class="sig-name descname"><span class="pre">pack</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>pack the rics and parameters to numpy arrays (one list of strings is provided to regenerate the names)
all the data will be packed into a single directory called data</p>
<p>systems with variables can not be packed</p>
<p>TODO: currently we only handle the ring attribute, needs to be more general if other attributes will be used in the future</p>
<p>TBI: we need to pack vdwpr and chapr</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.pick_params">
<code class="sig-name descname"><span class="pre">pick_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aft_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">at_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pardir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.pick_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Hhelper function to pick params from the dictionary pardir using permutations for the given ic
if len of aft_list == 1 (ic = vdw or cha) no permutations necessary
:Parameters:</p>
<blockquote>
<div><p>-aft_list(list): list of aftypes
-ic(str): name of internal coordinate
-pardir(dict): dictionary holding the parameters</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>-parname(str): parname
-params(list): list of the corresponding parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.read">
<code class="sig-name descname"><span class="pre">read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.read" title="Permalink to this definition">¶</a></dt>
<dd><p>read the ric/par files instead of assigning params
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>fname(str) : name of &lt;fname&gt;.par und &lt;fname.ric&gt; file</p></li>
<li><p>fit(bool, optional): specify if an fpar file should be read in,</p></li>
</ul>
<p>holding fitting information, defaults to False</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.remove_pars">
<code class="sig-name descname"><span class="pre">remove_pars</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.remove_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove Variables to write the numbers to the fpar file</p>
<p>Based on any identifier, variables can be deleted from the dictionary
Identifiers can be regular expressions
Usage:</p>
<blockquote>
<div><p>ff.remove_pars([‘d’])  – removes all dihedral variables
ff.remove_pars([‘a10’])  – removes all entries of angle 10, e.g. a10_0 &amp; a10_1
ff.remove_pars([‘b*_0’])  – removes all bond entries zero e.g. b1_0 &amp; b5_0, but keeps b1_1 and b5_1</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><p><strong>{list of strings} -- string identifiers</strong><strong>, </strong><strong>can be regexp</strong><strong> (</strong><strong>default</strong> (<em>identifier</em>) – {[]})</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.set_def_sig">
<code class="sig-name descname"><span class="pre">set_def_sig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.set_def_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to set default parameters for gaussian width for the the charges
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>ind(int): atom index</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.set_def_vdw">
<code class="sig-name descname"><span class="pre">set_def_vdw</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.set_def_vdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to set default vdw parameters for a given atom index
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>ind(int): atom index</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.setup_pair_potentials">
<code class="sig-name descname"><span class="pre">setup_pair_potentials</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.setup_pair_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to setup the pair potentials based on the per atom type assigned parameters
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>radfact (int): factor to be multiplied during radius generation, default to 1.0</p></li>
<li><p>radrule (str): radiusrule, default to arithmetic</p></li>
<li><p>epsrule (str): epsilonrule, default to geometric</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.split_parname">
<code class="sig-name descname"><span class="pre">split_parname</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.split_parname" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to exploit the necessary information from the parname:
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>name(str): parname</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><ul class="simple">
<li><p>pot(str): potential type</p></li>
<li><p>ref(str): name of the reference system</p></li>
<li><p>aftypes(list): list of aftype names</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.to_latex">
<code class="sig-name descname"><span class="pre">to_latex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refsys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.to_latex" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to publish parameters as latex tables. This method needs pandas installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>refsys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – reference system for which the parameters should
be published.</p></li>
<li><p><strong>ic</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Internal coordinate for which the parameters should
be published</p></li>
<li><p><strong>datypes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – Defaults to None. Dictionary to
convert atomtypes to more readable types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>latex code as str</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.unpack">
<code class="sig-name descname"><span class="pre">unpack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>unpack data using exactly the structure produced in pack</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.update_molid">
<code class="sig-name descname"><span class="pre">update_molid</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.update_molid" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to update molid attribute in the vdw ics after things have changed in the parent mol’s molid</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.upload_params">
<code class="sig-name descname"><span class="pre">upload_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbrefname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.upload_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to upload interactively the parameters to the already connected db.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>FF(str): Name of the FF</p></li>
<li><p>refname(str): name of the refsystem for which params should be uploaded</p></li>
<li><p>dbrefname(str, optional): name of the refsystem in the db</p></li>
<li><p>azone(bool, optional): boolean flag indicating if an active zone entry in</p></li>
</ul>
<p>the db should be created, defaults to True
- atfix(list, optional): list of special atypes, which should be created
in the db for the reference system, defaults to None
- interactive(bool, optional): specify if an interactive upload should be
done, defaults to True</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.varnames2par">
<code class="sig-name descname"><span class="pre">varnames2par</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.varnames2par" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces the paramters in the variables dictionary to be written in the internal
data structures</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.write" title="Permalink to this definition">¶</a></dt>
<dd><p>write the rics including the referencing types to an ascii file
called &lt;fname&gt;.ric and the parameters to &lt;fname&gt;.par
:Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>fname(str): fname</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ff.write_key">
<code class="sig-name descname"><span class="pre">write_key</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atype_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atype_addendum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_default_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ff.write_key" title="Permalink to this definition">¶</a></dt>
<dd><p>author: Julian
try to write a key file from the data available in the class
needs then to be merged manually in case there is only a partial system
#### !!!! EQUIVALENCES ARE MISSING !!!! ####</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.groups">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">groups</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.groups.find_group_occurence_atype">
<code class="sig-name descname"><span class="pre">find_group_occurence_atype</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.groups.find_group_occurence_atype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.groups.get_group_names">
<code class="sig-name descname"><span class="pre">get_group_names</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.groups.get_group_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.groups.register_group">
<code class="sig-name descname"><span class="pre">register_group</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_def</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.groups.register_group" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.groups.register_group_atype">
<code class="sig-name descname"><span class="pre">register_group_atype</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ends_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.groups.register_group_atype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.groups.walk_bond">
<code class="sig-name descname"><span class="pre">walk_bond</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_ind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continue_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_at_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.groups.walk_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>get group by walking over atoms using the connectivity stopping at certain atom types</p>
<p>[description]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a><em>]</em>) – [description]</p></li>
<li><p><strong>start_ind</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a><em>]</em>) – [description]</p></li>
<li><p><strong>inds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – Defaults to []. [description]</p></li>
<li><p><strong>continue_at</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – Defaults to []. [description]</p></li>
<li><p><strong>stop_at</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – Defaults to []. [description]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)">type</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.molecules">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">molecules</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#molsys.addon.base.base" title="molsys.addon.base.base"><code class="xref py py-class docutils literal notranslate"><span class="pre">base.base</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.molecules.add_molecule">
<code class="sig-name descname"><span class="pre">add_molecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newmol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">packbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_pack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.molecules.add_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a molecule to the parent mol object</p>
<p>A molecules is a sub mol object that can be added to the parent system many times</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>-</em>) – nonperiodic molecule to be added (must be ONE connected molecule)</p></li>
<li><p><strong>pack</strong> (<em>-</em>) – defaults to False: if True use packmol to pack (needs to be installed and in the path)</p></li>
<li><p><strong>packbound</strong> (<em>-</em>) – defaults to 0.5: distance in Angstrom to reduce the box for packmol filling</p></li>
<li><p><strong>ff</strong> (<em>-</em>) – dummy variable added for legacy reasons</p></li>
<li><p><strong>custom_pack</strong> (<em>-</em>) – if given, use this string to define the box of interest</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.molecules.get_names">
<code class="sig-name descname"><span class="pre">get_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">legacy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.molecules.get_names" title="Permalink to this definition">¶</a></dt>
<dd><p>get a list of the molecule names stored in the default molecules dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>legacy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Defaults to True. if True, remove the name of the parent mol</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of strings of molecule names</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.obabel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">obabel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.obabel.cansmiles">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">cansmiles</span></code><a class="headerlink" href="#molsys.addon.obabel.cansmiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.check_chirality">
<code class="sig-name descname"><span class="pre">check_chirality</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.check_chirality" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.determine_rings">
<code class="sig-name descname"><span class="pre">determine_rings</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.determine_rings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.ff">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ff</span></code><a class="headerlink" href="#molsys.addon.obabel.ff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.ff_opt">
<code class="sig-name descname"><span class="pre">ff_opt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gconv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.ff_opt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.get_aromatic">
<code class="sig-name descname"><span class="pre">get_aromatic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.get_aromatic" title="Permalink to this definition">¶</a></dt>
<dd><p>get indices of all aromatic ring atoms</p>
<p>NOTE: openbabel seems not to properly detect all heteraromatic rings … not clear to me why.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>atom indices</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.get_aromatic_ringsystems">
<code class="sig-name descname"><span class="pre">get_aromatic_ringsystems</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.get_aromatic_ringsystems" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.get_ff_energy">
<code class="sig-name descname"><span class="pre">get_ff_energy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.get_ff_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.get_ff_gradient">
<code class="sig-name descname"><span class="pre">get_ff_gradient</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.get_ff_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>get obabel ff gradient</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.get_ff_hessian">
<code class="sig-name descname"><span class="pre">get_ff_hessian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.get_ff_hessian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.get_obmol_coords">
<code class="sig-name descname"><span class="pre">get_obmol_coords</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.get_obmol_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Get OBMol coords and put them into the parent mol object</p>
<p>Needs to be called after pybel or openbabel operations that chenged the coords</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.localopt">
<code class="sig-name descname"><span class="pre">localopt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.localopt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.plot_svg">
<code class="sig-name descname"><span class="pre">plot_svg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.plot_svg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.setup_ff">
<code class="sig-name descname"><span class="pre">setup_ff</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.setup_ff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.smiles">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">smiles</span></code><a class="headerlink" href="#molsys.addon.obabel.smiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.obabel.smiles2filename">
<code class="sig-name descname"><span class="pre">smiles2filename</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.obabel.smiles2filename" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a smiles string to smoething useable as a filename</p>
<p>we replace
* -&gt; x
/ -&gt; y
-&gt; z
# -&gt; ^
(do we need to replace parantheses?)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smi</strong> (<em>string</em>) – smiles or canonical smiles</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.ptg">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">ptg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigen_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class to analyze the point group of a molecule. The general outline of
the algorithm is as follows:</p>
<ol class="arabic">
<li><p>Center the molecule around its center of mass.</p></li>
<li><p>Compute the inertia tensor and the eigenvalues and eigenvectors.</p></li>
<li><p>Handle the symmetry detection based on eigenvalues.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Linear molecules have one zero eigenvalue. Possible symmetry
operations are C*v or D*v</p></li>
<li><p>Asymetric top molecules have all different eigenvalues. The
maximum rotational symmetry in such molecules is 2</p></li>
<li><p>Symmetric top molecules have 1 unique eigenvalue, which gives a
unique rotation axis.  All axial point groups are possible
except the cubic groups (T &amp; O) and I.</p></li>
<li><p>Spherical top molecules have all three eigenvalues equal. They
have the rare T, O or I point groups.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
<dl class="py attribute">
<dt id="molsys.addon.ptg.sch_symbol">
<code class="sig-name descname"><span class="pre">sch_symbol</span></code><a class="headerlink" href="#molsys.addon.ptg.sch_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Schoenflies symbol of the detected point group.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.analyze">
<code class="sig-name descname"><span class="pre">analyze</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.analyze" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.get_equivalent_atoms">
<code class="sig-name descname"><span class="pre">get_equivalent_atoms</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.get_equivalent_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns sets of equivalent atoms with symmetry operations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The returned dictionary has two possible keys:</p>
<p><code class="docutils literal notranslate"><span class="pre">eq_sets</span></code>:
A dictionary of indices mapping to sets of indices,
each key maps to indices of all equivalent atoms.
The keys are guaranteed to be not equivalent.</p>
<p><code class="docutils literal notranslate"><span class="pre">sym_ops</span></code>:
Twofold nested dictionary.
<code class="docutils literal notranslate"><span class="pre">operations[i][j]</span></code> gives the symmetry operation
that maps atom <code class="docutils literal notranslate"><span class="pre">i</span></code> unto <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.get_pointgroup">
<code class="sig-name descname"><span class="pre">get_pointgroup</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.get_pointgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a PointGroup object for the molecule.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.get_symmetry_operations">
<code class="sig-name descname"><span class="pre">get_symmetry_operations</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.get_symmetry_operations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return symmetry operations as a list of SymmOp objects.
Returns Cartesian coord symmops.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of symmetry operations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>([SymmOp])</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="molsys.addon.ptg.inversion_op">
<code class="sig-name descname"><span class="pre">inversion_op</span></code><em class="property"> <span class="pre">=</span> <span class="pre">Rot:</span> <span class="pre">[[-1.</span> <span class="pre">-0.</span> <span class="pre">-0.]</span>&#160; <span class="pre">[-0.</span> <span class="pre">-1.</span> <span class="pre">-0.]</span>&#160; <span class="pre">[-0.</span> <span class="pre">-0.</span> <span class="pre">-1.]]</span> <span class="pre">tau</span> <span class="pre">[0.</span> <span class="pre">0.</span> <span class="pre">0.]</span></em><a class="headerlink" href="#molsys.addon.ptg.inversion_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.is_valid_op">
<code class="sig-name descname"><span class="pre">is_valid_op</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symmop</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.is_valid_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a particular symmetry operation is a valid symmetry operation
for a molecule, i.e., the operation maps all atoms to another
equivalent atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symmop</strong> (<em>SymmOp</em>) – Symmetry operation to test.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether SymmOp is valid for Molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.setup_pointgroup">
<code class="sig-name descname"><span class="pre">setup_pointgroup</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.setup_pointgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Setups as attribute the PointGroup object for the molecule.</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.ptg.symmetrize_molecule">
<code class="sig-name descname"><span class="pre">symmetrize_molecule</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.ptg.symmetrize_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a symmetrized molecule</p>
<p>The equivalent atoms obtained via
<code class="xref py py-meth docutils literal notranslate"><span class="pre">get_equivalent_atoms()</span></code>
are rotated, mirrored… unto one position.
Then the average position is calculated.
The average position is rotated, mirrored… back with the inverse
of the previous symmetry operations, which gives the
symmetrized molecule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The returned dictionary has three possible keys:</p>
<p><code class="docutils literal notranslate"><span class="pre">sym_mol</span></code>:
A symmetrized molecule instance.</p>
<p><code class="docutils literal notranslate"><span class="pre">eq_sets</span></code>:
A dictionary of indices mapping to sets of indices,
each key maps to indices of all equivalent atoms.
The keys are guaranteed to be not equivalent.</p>
<p><code class="docutils literal notranslate"><span class="pre">sym_ops</span></code>:
Twofold nested dictionary.
<code class="docutils literal notranslate"><span class="pre">operations[i][j]</span></code> gives the symmetry operation
that maps atom <code class="docutils literal notranslate"><span class="pre">i</span></code> unto <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.topo">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">topo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.topo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.topo.RCSRname">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">RCSRname</span></code><a class="headerlink" href="#molsys.addon.topo.RCSRname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.coord_seq">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">coord_seq</span></code><a class="headerlink" href="#molsys.addon.topo.coord_seq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.extend_images">
<code class="sig-name descname"><span class="pre">extend_images</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.topo.extend_images" title="Permalink to this definition">¶</a></dt>
<dd><p>helper method to generate a new mol object where the periodic bonds are extended
to the next image as defined by the pconn</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.fix_topo_elems">
<code class="sig-name descname"><span class="pre">fix_topo_elems</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.topo.fix_topo_elems" title="Permalink to this definition">¶</a></dt>
<dd><p>call this method to set the elements in a topo file properly (from coord number)</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.set_topoinfo">
<code class="sig-name descname"><span class="pre">set_topoinfo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spgr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RCSRname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transitivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-1</span> <span class="pre">-1</span> <span class="pre">-1</span> <span class="pre">-1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.topo.set_topoinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>There are two ways to generate metadata (which have to come in group from a trusted source)
either systrekey/skey_mapping is generated by calling systrekey.js (RCSRname can be always retrieved)
or the info comes from systre (or reading a new topo mfpx file with topoinfo, which hs been generated by systre)
Of course it is possible to manually feed in some wrong info …</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skey</strong> (<em>string</em>) – systrekey</p></li>
<li><p><strong>mapping</strong> (<em>string</em>) – skey_mapping</p></li>
<li><p><strong>spgr</strong> (<em>string</em>) – spacegroup</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.skey_mapping">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">skey_mapping</span></code><a class="headerlink" href="#molsys.addon.topo.skey_mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.spgr">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">spgr</span></code><a class="headerlink" href="#molsys.addon.topo.spgr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.systrekey">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">systrekey</span></code><a class="headerlink" href="#molsys.addon.topo.systrekey" title="Permalink to this definition">¶</a></dt>
<dd><p>method calls javascript systreKey (must be installed) and computes the systreKey</p>
</dd></dl>

<dl class="py method">
<dt id="molsys.addon.topo.transitivity">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">transitivity</span></code><a class="headerlink" href="#molsys.addon.topo.transitivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.traj">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">traj</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdlp'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.traj" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.traj.next_frame">
<code class="sig-name descname"><span class="pre">next_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.traj.next_frame" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.traj.set_frame">
<code class="sig-name descname"><span class="pre">set_frame</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.traj.set_frame" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.traj.set_source">
<code class="sig-name descname"><span class="pre">set_source</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.traj.set_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.traj.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.traj.write" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="molsys.addon.wannier">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">molsys.addon.</span></code><code class="sig-name descname"><span class="pre">wannier</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcharges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'n':</span> <span class="pre">5.0,</span> <span class="pre">'na':</span> <span class="pre">9.0,</span> <span class="pre">'o':</span> <span class="pre">6.0}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#molsys.addon.base.base" title="molsys.addon.base.base"><code class="xref py py-class docutils literal notranslate"><span class="pre">base.base</span></code></a></p>
<dl class="py method">
<dt id="molsys.addon.wannier.atoms">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">atoms</span></code><a class="headerlink" href="#molsys.addon.wannier.atoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.calc_mol_dipole">
<code class="sig-name descname"><span class="pre">calc_mol_dipole</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.calc_mol_dipole" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.calc_mol_dipoles">
<code class="sig-name descname"><span class="pre">calc_mol_dipoles</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.calc_mol_dipoles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.calc_total_monopole">
<code class="sig-name descname"><span class="pre">calc_total_monopole</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.calc_total_monopole" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.centers">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">centers</span></code><a class="headerlink" href="#molsys.addon.wannier.centers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.charges">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">charges</span></code><a class="headerlink" href="#molsys.addon.wannier.charges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.find_shells">
<code class="sig-name descname"><span class="pre">find_shells</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.find_shells" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.natoms">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">natoms</span></code><a class="headerlink" href="#molsys.addon.wannier.natoms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.ncenters">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">ncenters</span></code><a class="headerlink" href="#molsys.addon.wannier.ncenters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.portion_centers">
<code class="sig-name descname"><span class="pre">portion_centers</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.portion_centers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.prep_molecules">
<code class="sig-name descname"><span class="pre">prep_molecules</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.prep_molecules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.read_charges_from_cp2k">
<code class="sig-name descname"><span class="pre">read_charges_from_cp2k</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MPA'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.read_charges_from_cp2k" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="molsys.addon.wannier.read_charges_from_tm">
<code class="sig-name descname"><span class="pre">read_charges_from_tm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ESP'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#molsys.addon.wannier.read_charges_from_tm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="molsys.fileIO.html" class="btn btn-neutral float-right" title="1.1.1.1.2. molsys.fileIO package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="molsys.html" class="btn btn-neutral float-left" title="1.1.1. molsys package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2021, Roberto Amabile, Johannes P. Duerholt, Julian Keupp, Rochus Schmid.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>